<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Option G: Paper Unfold - Manuscript Splash</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Amiri:wght@400;700&display=swap" rel="stylesheet">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: Georgia, serif;
      overflow: hidden;
    }

    .container {
      position: fixed;
      inset: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
      cursor: pointer;
      transition: background-color 0.5s;
    }

    .dark {
      background-color: #1a1512;
    }

    .light {
      background-color: #f5ede1;
    }

    .theme-toggle {
      position: fixed;
      top: 1.5rem;
      right: 1.5rem;
      z-index: 50;
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      border: 2px solid;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.3s;
    }

    .theme-toggle:hover {
      transform: scale(1.1);
    }

    .svg-container {
      position: relative;
      width: 100%;
      height: 100%;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 1rem;
    }

    svg {
      width: 100%;
      height: 100%;
      max-width: 80rem;
      max-height: 90vh;
      filter: drop-shadow(0 20px 40px rgba(0, 0, 0, 0.3));
    }

    .instruction {
      position: absolute;
      bottom: 3rem;
      left: 50%;
      transform: translateX(-50%);
      text-align: center;
      text-transform: uppercase;
      letter-spacing: 0.15em;
      font-size: 0.875rem;
      transition: opacity 0.5s;
    }

    .vignette {
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0.6;
    }

    .texture-overlay {
      position: absolute;
      inset: 0;
      pointer-events: none;
      opacity: 0.4;
      background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 400 400' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.8' numOctaves='4' seed='1'/%3E%3CfeColorMatrix type='saturate' values='0'/%3E%3C/filter%3E%3Crect width='400' height='400' filter='url(%23noise)' opacity='0.15'/%3E%3C/svg%3E");
    }

    button {
      background: none;
      border: none;
      cursor: pointer;
      font-family: inherit;
    }

    .cta-button {
      cursor: pointer;
      transition: all 0.3s;
    }

    .cta-button:hover rect {
      fill: currentColor;
    }
  </style>
</head>
<body>
  <div id="container" class="container dark">
    <!-- Texture overlay -->
    <div class="texture-overlay"></div>

    <!-- Theme toggle -->
    <button id="themeToggle" class="theme-toggle">
      <svg id="moonIcon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
      </svg>
      <svg id="sunIcon" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="display: none;">
        <circle cx="12" cy="12" r="5"></circle>
        <line x1="12" y1="1" x2="12" y2="3"></line>
        <line x1="12" y1="21" x2="12" y2="23"></line>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
        <line x1="1" y1="12" x2="3" y2="12"></line>
        <line x1="21" y1="12" x2="23" y2="12"></line>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
      </svg>
    </button>

    <!-- SVG Container -->
    <div class="svg-container">
      <svg id="manuscriptSvg" viewBox="0 0 800 600"></svg>
    </div>

    <!-- Touch instruction -->
    <div id="instruction" class="instruction">Touch to unfurl</div>

    <!-- Vignette -->
    <div class="vignette" id="vignette"></div>
  </div>

  <script>
    // State
    let darkMode = true;
    let unfurlProgress = 0;
    let isUnfurling = false;
    let hasStarted = false;

    // Elements
    const container = document.getElementById('container');
    const themeToggle = document.getElementById('themeToggle');
    const moonIcon = document.getElementById('moonIcon');
    const sunIcon = document.getElementById('sunIcon');
    const instruction = document.getElementById('instruction');
    const vignette = document.getElementById('vignette');
    const svg = document.getElementById('manuscriptSvg');

    // Colors
    const colors = {
      dark: {
        bg: '#1a1512',
        paper: '#2d2419',
        paperLight: '#3d3428',
        text: '#c9b896',
        textDark: '#8b7355',
        accent: '#d4a574',
        shadow: 'rgba(0, 0, 0, 0.7)',
        border: '#4a3f2f',
      },
      light: {
        bg: '#f5ede1',
        paper: '#f8f3e6',
        paperLight: '#fdfaf2',
        text: '#5d4e3a',
        textDark: '#3d2f1f',
        accent: '#8b6f47',
        shadow: 'rgba(61, 47, 31, 0.3)',
        border: '#d4c4a8',
      }
    };

    function getColors() {
      return darkMode ? colors.dark : colors.light;
    }

    function updateTheme() {
      const c = getColors();
      container.className = `container ${darkMode ? 'dark' : 'light'}`;
      container.style.backgroundColor = c.bg;
      themeToggle.style.borderColor = c.border;
      themeToggle.style.backgroundColor = c.paper;
      themeToggle.style.color = c.accent;
      instruction.style.color = c.textDark;
      vignette.style.background = `radial-gradient(circle at center, transparent 40%, ${c.bg} 100%)`;

      moonIcon.style.display = darkMode ? 'none' : 'block';
      sunIcon.style.display = darkMode ? 'block' : 'none';

      renderManuscript();
    }

    function renderManuscript() {
      const c = getColors();
      const progress = unfurlProgress;

      svg.innerHTML = `
        <defs>
          <!-- Paper texture filter -->
          <filter id="paperTexture" x="0%" y="0%" width="100%" height="100%">
            <feTurbulence type="fractalNoise" baseFrequency="0.6" numOctaves="5" seed="2" />
            <feColorMatrix type="saturate" values="0" />
            <feComponentTransfer>
              <feFuncA type="discrete" tableValues="0.05" />
            </feComponentTransfer>
            <feBlend mode="multiply" in2="SourceGraphic" />
          </filter>

          <!-- Aging effect -->
          <filter id="aging" x="-50%" y="-50%" width="200%" height="200%">
            <feTurbulence type="fractalNoise" baseFrequency="0.02" numOctaves="3" seed="5" />
            <feColorMatrix type="saturate" values="0.3" />
            <feComponentTransfer>
              <feFuncA type="discrete" tableValues="0 0.03 0.05 0.02 0" />
            </feComponentTransfer>
            <feBlend mode="multiply" in2="SourceGraphic" />
          </filter>

          <!-- Crease shadow -->
          <linearGradient id="creaseShadow" x1="0%" y1="0%" x2="100%" y2="0%">
            <stop offset="0%" stop-color="${c.shadow}" stop-opacity="0.6" />
            <stop offset="30%" stop-color="${c.shadow}" stop-opacity="0.2" />
            <stop offset="50%" stop-color="${c.paperLight}" stop-opacity="0" />
            <stop offset="100%" stop-color="${c.paperLight}" stop-opacity="0" />
          </linearGradient>

          <!-- Paper highlight -->
          <linearGradient id="paperHighlight" x1="0%" y1="0%" x2="100%" y2="100%">
            <stop offset="0%" stop-color="${c.paperLight}" stop-opacity="0.8" />
            <stop offset="100%" stop-color="${c.paper}" stop-opacity="1" />
          </linearGradient>

          <!-- Unfurl mask -->
          <mask id="unfurlMask">
            <rect x="${800 - (800 * progress)}" y="0" width="${800 * progress}" height="600" fill="white" />
          </mask>
        </defs>

        <!-- Background -->
        <rect x="0" y="0" width="800" height="600" fill="${c.paper}" filter="url(#paperTexture)" />
        <rect x="0" y="0" width="800" height="600" fill="${c.paper}" filter="url(#aging)" opacity="0.6" />

        <!-- Folded section -->
        <g opacity="${1 - progress}" transform="translate(${progress * 100}, 0)">
          <path d="M ${650 - progress * 200} 0 L 800 0 L 800 600 L ${650 - progress * 200} 600 Z" fill="url(#paperHighlight)" />
          <rect x="${650 - progress * 200}" y="0" width="150" height="600" fill="url(#creaseShadow)" />
          <line x1="${650 - progress * 200}" y1="0" x2="${650 - progress * 200}" y2="600" stroke="${c.paperLight}" stroke-width="2" opacity="0.5" />
        </g>

        <!-- Content (masked) -->
        <g mask="url(#unfurlMask)">
          <!-- Border -->
          <rect x="40" y="40" width="720" height="520" fill="none" stroke="${c.border}" stroke-width="2" opacity="0.6" />

          <!-- Corner ornaments -->
          <g opacity="0.5">
            <path d="M 60 60 L 100 60 M 60 60 L 60 100" stroke="${c.accent}" stroke-width="3" stroke-linecap="round" />
            <path d="M 740 60 L 700 60 M 740 60 L 740 100" stroke="${c.accent}" stroke-width="3" stroke-linecap="round" />
            <path d="M 60 540 L 100 540 M 60 540 L 60 500" stroke="${c.accent}" stroke-width="3" stroke-linecap="round" />
            <path d="M 740 540 L 700 540 M 740 540 L 740 500" stroke="${c.accent}" stroke-width="3" stroke-linecap="round" />
          </g>

          <!-- Arabic title -->
          <text x="400" y="180" text-anchor="middle" font-family="Amiri, serif" font-size="72" font-weight="bold" fill="${c.text}" letter-spacing="0.05em">بالعربي</text>

          <!-- English title -->
          <text x="400" y="240" text-anchor="middle" font-family="Georgia, serif" font-size="48" font-weight="300" font-style="italic" fill="${c.textDark}" letter-spacing="0.1em">poetry</text>

          <!-- Divider -->
          <g opacity="0.6">
            <line x1="300" y1="280" x2="380" y2="280" stroke="${c.accent}" stroke-width="2" />
            <circle cx="400" cy="280" r="4" fill="${c.accent}" />
            <line x1="420" y1="280" x2="500" y2="280" stroke="${c.accent}" stroke-width="2" />
          </g>

          <!-- Subtitles -->
          <text x="400" y="330" text-anchor="middle" font-family="Amiri, serif" font-size="24" fill="${c.textDark}" opacity="0.8">الشعر العربي الكلاسيكي</text>
          <text x="400" y="365" text-anchor="middle" font-family="Georgia, serif" font-size="16" fill="${c.textDark}" opacity="0.7" letter-spacing="0.15em">CLASSICAL ARABIC VERSE</text>

          <!-- CTA Button -->
          ${progress > 0.8 ? `
            <g class="cta-button" opacity="${Math.min((progress - 0.8) / 0.2, 1)}">
              <rect x="300" y="420" width="200" height="50" fill="${progress >= 1 ? c.paper : 'none'}" stroke="${c.accent}" stroke-width="2" rx="4" />
              <text x="400" y="453" text-anchor="middle" font-family="Georgia, serif" font-size="14" font-weight="600" fill="${c.accent}" letter-spacing="0.2em">ENTER</text>
            </g>
          ` : ''}

          <!-- Bottom flourish -->
          <g opacity="0.4">
            <path d="M 350 510 Q 400 495 450 510" fill="none" stroke="${c.accent}" stroke-width="1.5" />
            <circle cx="350" cy="510" r="2" fill="${c.accent}" />
            <circle cx="450" cy="510" r="2" fill="${c.accent}" />
          </g>
        </g>

        <!-- Paper curl -->
        ${progress < 1 ? `
          <g opacity="${1 - progress}">
            <ellipse cx="${800 - (800 * progress) - 10}" cy="300" rx="15" ry="250" fill="${c.paperLight}" opacity="0.8" />
            <ellipse cx="${800 - (800 * progress) - 10}" cy="300" rx="8" ry="240" fill="${c.shadow}" opacity="0.3" />
          </g>
        ` : ''}
      `;
    }

    function startUnfurl() {
      if (hasStarted) return;

      isUnfurling = true;
      hasStarted = true;

      const duration = 3000;
      const startTime = Date.now();

      function animate() {
        const elapsed = Date.now() - startTime;
        const progress = Math.min(elapsed / duration, 1);

        // Ease-out cubic
        const eased = 1 - Math.pow(1 - progress, 3);
        unfurlProgress = eased;

        renderManuscript();

        // Update instruction opacity
        instruction.style.opacity = Math.max(0, 1 - progress * 5);
        if (progress < 0.05) {
          instruction.textContent = 'Touch to unfurl';
        } else if (progress < 1) {
          instruction.textContent = 'Touch to accelerate';
        }

        if (progress < 1) {
          requestAnimationFrame(animate);
        }
      }

      requestAnimationFrame(animate);
    }

    function accelerate() {
      if (!hasStarted) {
        startUnfurl();
      } else if (unfurlProgress < 1) {
        unfurlProgress = 1;
        renderManuscript();
        instruction.style.opacity = 0;
      }
    }

    function handleEnter() {
      alert('Entering poetry application...\n\nThis is a demo. In the real app, this would navigate to the main poetry viewer.');
    }

    // Event listeners
    themeToggle.addEventListener('click', (e) => {
      e.stopPropagation();
      darkMode = !darkMode;
      updateTheme();
    });

    container.addEventListener('click', (e) => {
      if (e.target.closest('.cta-button')) {
        handleEnter();
      } else {
        accelerate();
      }
    });

    // Initialize
    updateTheme();
    setTimeout(startUnfurl, 300);
  </script>
</body>
</html>
